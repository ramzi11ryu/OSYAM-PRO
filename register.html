<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†ØµØ© Ø±Ù…Ø¶Ø§Ù† - Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± + Ø§Ù„Ù…Ù‡Ø§Ù…</title>

<!-- Ø´Ø±ÙŠØ· Ø¥Ø¹Ù„Ø§Ù† Ø±Ù…Ø¶Ø§Ù† -->
<style>
.ramadan-banner{
    width:100%;
    text-align:center;
    font-size:20px;
    font-weight:bold;
    padding:10px 0;
    background:#000;
    color:#fff;
    text-shadow: 0 0 5px #fff, 0 0 10px #fff;
    animation:glow 2s ease-in-out infinite alternate;
    box-shadow:0 4px 12px rgba(0,0,0,0.5);
    position:sticky;
    top:0;
    z-index:999;
}
@keyframes glow{
    0%{ text-shadow:0 0 5px #fff,0 0 10px #fff; color:#e0e0e0; }
    50%{ text-shadow:0 0 15px #fff,0 0 30px #fff; color:#fff; }
    100%{ text-shadow:0 0 5px #fff,0 0 10px #fff; color:#e0e0e0; }
}
body{margin:0;font-family:Arial;background:#1f1f1f;color:#e0e0e0;}
header{background:#000;color:#fff;padding:15px;text-align:center;font-weight:bold;font-size:22px;}
.container{padding:15px;}
.card{
    background: linear-gradient(145deg,#2a2a2a,#1a1a1a);
    color:#e0e0e0;
    padding:20px;
    border-radius:12px;
    margin-bottom:20px;
    box-shadow:0 4px 12px rgba(0,0,0,0.7);
    transition: all 0.3s ease;
    border:2px solid #333;
}
.card:hover{
    box-shadow:0 8px 20px rgba(255,255,255,0.2);
    border:2px solid #888;
}
button{
    padding:10px 20px;
    border:none;
    border-radius:8px;
    margin-top:15px;
    color:#fff;
    font-size:16px;
    cursor:pointer;
    background:#333;
    box-shadow:0 4px 8px rgba(0,0,0,0.7);
    transition: all 0.3s ease;
}
button:hover{
    background:#555;
    box-shadow:0 6px 12px rgba(255,255,255,0.3);
}
button:disabled{
    background:gray;
    cursor:not-allowed;
}
.message{margin-bottom:10px;font-size:16px;color:#fff;}
.info{
    background:#2a2a2a;
    padding:10px;
    border-radius:10px;
    margin-bottom:15px;
    color:#e0e0e0;
    box-shadow:0 4px 8px rgba(0,0,0,0.5);
}
.overlay{
    position:fixed;
    top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.8);
    display:none;
    justify-content:center;
    align-items:center;
    z-index:10000;
}
.popup{
    background:#2a2a2a;
    color:#fff;
    padding:20px;
    border-radius:12px;
    max-width:400px;
    text-align:center;
    box-shadow:0 8px 16px rgba(0,0,0,0.9);
}
.popup button{
    margin-top:15px;
    padding:8px 16px;
    border:none;
    border-radius:8px;
    background:#555;
    color:#fff;
    cursor:pointer;
}
.popup button:hover{background:#777;}
</style>
</head>
<body>

<div class="ramadan-banner">ğŸŒ™ Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… - ÙƒÙ„ ÙŠÙˆÙ… Ù…Ø¨Ø§Ø±Ùƒ! ğŸŒ™</div>
<header>Ù…Ù†ØµØ© Ø±Ù…Ø¶Ø§Ù† ğŸŒ™ - Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙˆØ§Ù„Ù…Ù‡Ø§Ù…</header>

<div class="container">
<div class="info">
Ø±ØµÙŠØ¯Ùƒ: <span id="balance">0</span> Ø¯Ø¬<br>
Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: <span id="planName">Ù„Ø§ ØªÙˆØ¬Ø¯</span><br>
Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: <span id="daysLeft">0</span>
</div>

<!-- Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± -->
<div class="card">
<h3>VP C</h3>
Ø§Ù„Ø³Ø¹Ø±: 700 Ø¯Ø¬<br>
Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ: 50 Ø¯Ø¬<br>
Ø§Ù„Ù…Ø¯Ø©: 60 ÙŠÙˆÙ…
<button onclick="requestInvestment('VP C',700)">Ø·Ù„Ø¨ Ø§Ø³ØªØ«Ù…Ø§Ø±</button>
</div>

<div class="card">
<h3>VP G</h3>
Ø§Ù„Ø³Ø¹Ø±: 1200 Ø¯Ø¬<br>
Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ: 100 Ø¯Ø¬<br>
Ø§Ù„Ù…Ø¯Ø©: 60 ÙŠÙˆÙ…
<button onclick="requestInvestment('VP G',1200)">Ø·Ù„Ø¨ Ø§Ø³ØªØ«Ù…Ø§Ø±</button>
</div>

<div class="card">
<h3>VP R</h3>
Ø§Ù„Ø³Ø¹Ø±: 2000 Ø¯Ø¬<br>
Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ: 150 Ø¯Ø¬<br>
Ø§Ù„Ù…Ø¯Ø©: 60 ÙŠÙˆÙ…
<button onclick="requestInvestment('VP R',2000)">Ø·Ù„Ø¨ Ø§Ø³ØªØ«Ù…Ø§Ø±</button>
</div>

<!-- Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ© -->
<h2 style="margin-top:20px;text-align:center;">Ù…Ù‡Ø§Ù… Ø±Ù…Ø¶Ø§Ù† Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>

<div class="card">
<h3>Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</h3>
<div class="message" id="task1Msg"></div>
<button id="task1Btn" onclick="completeTask('task1',0)">Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†ÙŠØ©</button>
<div id="task1Timer" style="margin-top:5px;color:#fff;"></div>
</div>

<div class="card">
<h3>Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©</h3>
<div class="message" id="task2Msg"></div>
<button id="task2Btn" onclick="completeTask('task2',1)">Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†ÙŠØ©</button>
<div id="task2Timer" style="margin-top:5px;color:#fff;"></div>
</div>

<div class="card">
<h3>Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©</h3>
<div class="message" id="task3Msg"></div>
<button id="task3Btn" onclick="completeTask('task3',2)">Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¯ÙŠÙ†ÙŠØ©</button>
<div id="task3Timer" style="margin-top:5px;color:#fff;"></div>
</div>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<div class="overlay" id="overlay">
    <div class="popup">
        <div id="popupMessage">ğŸ•Œ Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… ğŸŒ™</div>
        <button id="closePopupBtn">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { getFirestore, doc, getDoc, collection, addDoc, updateDoc, serverTimestamp, onSnapshot } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBiQ4dHe4sbKDIrsyF8WdpjV3sY4qAxU4E",
  authDomain: "osim-d1821.firebaseapp.com",
  projectId: "osim-d1821",
  storageBucket: "osim-d1821.firebasestorage.app",
  messagingSenderId: "464951343183",
  appId: "1:464951343183:web:21c7615a90e4f38385923a"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser;
let profits = {"C":50,"G":100,"R":150};

const messages = [
"ğŸ•Œ ØµÙÙ„ Ø±Ø­Ù…Ùƒ ÙˆØ£Ø­Ø³Ù† Ø¥Ù„Ù‰ Ø¬Ø§Ø±Ùƒ","ğŸ“– ØªÙ„Ø§ÙˆØ© Ø§Ù„Ù‚Ø±Ø¢Ù† Ù†ÙˆØ± Ù„Ù„Ù‚Ù„ÙˆØ¨","ğŸ¤² Ø§Ù„ØµØ¯Ù‚Ø© ØªØ·ÙØ¦ ØºØ¶Ø¨ Ø§Ù„Ø±Ø­Ù…Ù†",
"ğŸ•Œ Ù…Ù† ØµÙ„Ù‰ Ø§Ù„Ø¨Ø±Ø¯ÙŠÙ† Ø¯Ø®Ù„ Ø§Ù„Ø¬Ù†Ø©","ğŸ“– ØªØ¹Ù„Ù… Ø§Ù„Ø¹Ù„Ù… ÙØ±ÙŠØ¶Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ø³Ù„Ù…","ğŸ¤² Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø£Ø¯ÙˆÙ…Ù‡Ø§ ÙˆØ¥Ù† Ù‚Ù„",
"ğŸ•Œ ØµÙˆÙ… ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯ ÙŠÙƒÙØ± Ø°Ù†ÙˆØ¨ Ø³Ù†Ø©","ğŸ“– Ø§Ù„Ù‚Ø±Ø¢Ù† Ø´ÙÙŠØ¹ Ù„Ø£ØµØ­Ø§Ø¨Ù‡ ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø©","ğŸ¤² Ø¨Ø± Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ† Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¬Ù†Ø©",
"ğŸ•Œ Ø°ÙƒØ± Ø§Ù„Ù„Ù‡ Ø¹Ø¨Ø§Ø¯Ø© ÙŠÙˆÙ…ÙŠØ©","ğŸ“– Ø§Ù„ØµØ¨Ø± Ù…ÙØªØ§Ø­ Ø§Ù„ÙØ±Ø¬","ğŸ¤² Ø§Ù„Ø¥Ø­Ø³Ø§Ù† Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø§Ø³ Ù…Ø­Ø¨ÙˆØ¨ Ø¹Ù†Ø¯ Ø§Ù„Ù„Ù‡",
"ğŸ•Œ ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø± Ø¬Ù…Ø§Ø¹Ø© ÙÙŠ Ø§Ù„Ù…Ø³Ø¬Ø¯","ğŸ“– Ù‚Ø±Ø§Ø¡Ø© Ø³ÙˆØ±Ø© Ø§Ù„Ø¨Ù‚Ø±Ø© Ø¨Ø±ÙƒØ© Ù„Ù„Ø¨ÙŠØª","ğŸ¤² Ø­Ø³Ù† Ø§Ù„Ø®Ù„Ù‚ Ø£Ø­Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡",
"ğŸ•Œ ØµÙˆÙ… Ø±Ù…Ø¶Ø§Ù† Ø¹Ø¨Ø§Ø¯Ø© ÙˆØ·Ø§Ø¹Ø©","ğŸ“– Ø§Ù„Ø¯Ø¹Ø§Ø¡ ÙŠØ±ÙØ¹ Ø§Ù„Ø¨Ù„Ø§Ø¡","ğŸ¤² Ø±ÙÙ‚ Ø¨Ø§Ù„Ø­ÙŠÙˆØ§Ù† Ø¹Ø¨Ø§Ø¯Ø©",
"ğŸ•Œ Ø§Ù„ØªØµØ¯Ù‚ Ø³Ø± Ø§Ù„Ø®Ù„ÙˆØ¯","ğŸ“– Ø§Ù„Ø¯Ø¹Ø§Ø¡ Ù„Ù„Ù…Ø¤Ù…Ù†ÙŠÙ† Ø­Ø³Ù† Ø¹Ø¸ÙŠÙ…","ğŸ¤² Ø§Ù„Ø§Ø¨ØªØ³Ø§Ù…Ø© ÙÙŠ ÙˆØ¬Ù‡ Ø£Ø®ÙŠÙƒ ØµØ¯Ù‚Ø©",
"ğŸ•Œ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø©","ğŸ“– Ø§Ù„Ø¥Ø­Ø³Ø§Ù† Ù„Ù„Ø¬Ø§Ø±","ğŸ¤² ØµÙ„Ø© Ø§Ù„Ø±Ø­Ù… ØªØ²ÙŠØ¯ Ø§Ù„Ø±Ø²Ù‚",
"ğŸ•Œ Ø§Ù„ØªÙˆØ¨Ø© Ø§Ù„Ù†ØµÙˆØ­ ØªØ¬Ù„Ø¨ Ø±Ø¶Ø§ Ø§Ù„Ù„Ù‡","ğŸ“– Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø£Ø°ÙƒØ§Ø± ØµØ¨Ø§Ø­Ø§Ù‹ ÙˆÙ…Ø³Ø§Ø¡Ù‹","ğŸ¤² Ø§Ù„Ø­Ø¬ ÙˆØ§Ù„Ø¹Ù…Ø±Ø© Ø£Ø¹Ù…Ø§Ù„ Ù…Ù‚Ø¨ÙˆÙ„Ø©",
"ğŸ•Œ Ø°ÙƒØ± Ø§Ù„Ù„Ù‡ ÙÙŠ ÙƒÙ„ ÙˆÙ‚Øª","ğŸ“– ØµØ¨Ø± Ø§Ù„Ø¥Ù†Ø³Ø§Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù„Ø§Ø¡","ğŸ¤² Ø§Ù„Ø¥Ø­Ø³Ø§Ù† Ù„Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†"
];

let dailyMessages = ["", "", ""];

onAuthStateChanged(auth, async (user)=>{
    if(user){
        currentUser = user;
        await loadUser();
        await loadDailyMessages();
        startTaskTimers();
    } else {
        alert("Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§");
        window.location.href="login.html";
    }
});

// ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
async function loadUser(){
    const userRef = doc(db,"users",currentUser.uid);
    const snap = await getDoc(userRef);
    if(!snap.exists()) return;
    const data = snap.data();

    document.getElementById("balance").innerText = data.balance || 0;
    document.getElementById("planName").innerText = data.plan || "Ù„Ø§ ØªÙˆØ¬Ø¯";

    if(data.planEnd){
        let end = new Date(data.planEnd);
        let now = new Date();
        let diff = Math.ceil((end - now)/(1000*60*60*24));
        document.getElementById("daysLeft").innerText = diff>0 ? diff : 0;
    }

    ["task1","task2","task3"].forEach(task=>{
        if(data[task]){
            let last = new Date(data[task]);
            let diff = (new Date() - last)/(1000*60*60);
            if(diff < 24){
                document.getElementById(task+"Btn").disabled = true;
            }
        }
    });

    onSnapshot(collection(db,"investmentRequests"), snapshot=>{
        snapshot.docs.forEach(async docSnap=>{
            const req = docSnap.data();
            if(req.userId===currentUser.uid && req.status==="Ù…ÙˆØ§ÙÙ‚" && !data.planStart){
                let startDate = new Date();
                let endDate = new Date();
                endDate.setDate(startDate.getDate()+60);

                let newBalance = (data.balance || 0) - req.price;

                await updateDoc(userRef,{
                    balance: newBalance,
                    plan: req.plan,
                    planStart: startDate.toISOString(),
                    planEnd: endDate.toISOString()
                });

                alert("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ø³ØªØ«Ù…Ø§Ø±Ùƒ Ø¨Ø¹Ø¯ Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© âœ…");
                location.reload();
            }
        });
    });
}

// Ø·Ù„Ø¨ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±
window.requestInvestment = async function(planName,price){
    const userRef = doc(db,"users",currentUser.uid);
    const snap = await getDoc(userRef);
    const data = snap.data();

    if(data.balance < price){
        alert("Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ âŒ");
        return;
    }

    await addDoc(collection(db,"investmentRequests"),{
        userId: currentUser.uid,
        plan: planName,
        price: price,
        status: "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
        timestamp: serverTimestamp()
    });

    alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± âœ… Ø§Ù†ØªØ¸Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©");
};

// ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‡Ù…Ø©
window.completeTask = async function(taskId,index){
    const userRef = doc(db,"users",currentUser.uid);
    const snap = await getDoc(userRef);
    const data = snap.data();
    let now = new Date();

    if(data[taskId]){
        let last = new Date(data[taskId]);
        let diff = (now - last)/(1000*60*60);
        if(diff < 24){
            alert("â³ Ø§Ù„ÙˆÙ‚Øª Ù„Ù… ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ø¹Ø¯ØŒ Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹");
            return;
        }
    }

    await updateDoc(userRef,{ [taskId]: now.toISOString() });
    document.getElementById(taskId+"Btn").disabled = true;

    document.getElementById("popupMessage").innerText = dailyMessages[index] || "ğŸ•Œ Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… ğŸŒ™";
    document.getElementById("overlay").style.display = "flex";

    // ØªØ­Ù‚Ù‚ Ø§ÙƒØªÙ…Ø§Ù„ 3 Ù…Ù‡Ø§Ù…
    const updatedSnap = await getDoc(userRef);
    const updatedData = updatedSnap.data();
    let tasks = ["task1","task2","task3"];
    let completedToday = tasks.every(t=>{
        if(!updatedData[t]) return false;
        return (now - new Date(updatedData[t]))/(1000*60*60) < 24;
    });

    if(completedToday){
        let planChar = (updatedData.plan || "").slice(-1);
        let profitAmount = profits[planChar] || 0;
        let newBalance = (updatedData.balance || 0) + profitAmount;

        await updateDoc(userRef,{ balance: newBalance });
        document.getElementById("balance").innerText = newBalance;
        alert("ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! ÙƒÙ…Ù„Øª 3 Ù…Ù‡Ø§Ù… ÙˆØ±Ø¨Ø­Øª " + profitAmount + " Ø¯Ø¬");
    }
};

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
async function loadDailyMessages(){
    const userRef = doc(db,"users",currentUser.uid);
    const snap = await getDoc(userRef);
    let data = snap.exists() ? snap.data() : {};
    let now = new Date();
    let dayIndex = 0;

    if(!data.lastPopup || data.popupIndex === undefined){
        dayIndex = 0;
        await updateDoc(userRef,{
            lastPopup: now.toISOString(),
            popupIndex: dayIndex
        });
    } else {
        let last = new Date(data.lastPopup);
        let diff = (now - last)/(1000*60*60);
        dayIndex = data.popupIndex || 0;
        if(diff >= 24){
            dayIndex = (dayIndex + 1) % 10;
            await updateDoc(userRef,{
                lastPopup: now.toISOString(),
                popupIndex: dayIndex
            });
        }
    }

    let start = dayIndex*3;
    dailyMessages = messages.slice(start, start+3);

    for(let i=1;i<=3;i++){
        if(dailyMessages[i-1]){
            document.getElementById(`task${i}Msg`).innerText = dailyMessages[i-1];
        }
    }
}

// Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„ÙƒÙ„ Ù…Ù‡Ù…Ø©
function updateTaskTimers(data){
    ["task1","task2","task3"].forEach(task=>{
        const timerEl = document.getElementById(task+"Timer");
        if(data[task]){
            let last = new Date(data[task]);
            let now = new Date();
            let diff = 24*60*60*1000 - (now - last);
            if(diff > 0){
                let hours = Math.floor(diff/3600000);
                let minutes = Math.floor((diff%3600000)/60000);
                let seconds = Math.floor((diff%60000)/1000);
                timerEl.innerText = `â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${hours}Ø³ ${minutes}Ø¯ ${seconds}Ø«`;
                document.getElementById(task+"Btn").disabled = true;
            } else {
                timerEl.innerText = "âœ… ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø¢Ù†";
                document.getElementById(task+"Btn").disabled = false;
            }
        } else {
            timerEl.innerText = "âœ… ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø¢Ù†";
            document.getElementById(task+"Btn").disabled = false;
        }
    });
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø¯ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
function startTaskTimers(){
    setInterval(async ()=>{
        if(!currentUser) return;
        const userRef = doc(db,"users",currentUser.uid);
        const snap = await getDoc(userRef);
        if(snap.exists()){
            updateTaskTimers(snap.data());
        }
    },1000);
}

document.addEventListener("DOMContentLoaded", () => {
    const overlay = document.getElementById("overlay");
    const closeBtn = document.getElementById("closePopupBtn");
    closeBtn.onclick = () => { overlay.style.display = "none"; };
});
</script>
</body>
</html>
